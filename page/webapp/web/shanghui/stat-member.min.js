function initPage(){startMonth=common.getUrlParams("start_month"),endMonth=common.getUrlParams("end_month"),member=common.getUrlParams("member");var a=initPeriodArea(startMonth,endMonth);startDate=a[0],endDate=a[1],initPeriodAreaClick(),startMonth&&endMonth&&loadData()}function initPeriodAreaClick(){var c=$(".period-item");widget.bindTouchClick(c,function(a){var b,d,e,f,g,h,i,j;if($(a.target).toggleClass("common-bg"),b=!$(a.target).hasClass("common-bg"),d=$(a.target).attr("start_month"),e=$(".period-item.common-bg"),f=e.first().attr("start_month"),g=e.last().attr("start_month"),b&&(f>d||d>g));else for(h=0;h<c.length;h++)i=c.eq(h).attr("start_month"),b&&d>=i?c.eq(h).removeClass("common-bg"):i>f&&g>i&&c.eq(h).addClass("common-bg");e=$(".period-item.common-bg"),f=null,g=null,j="stat-member.html?member="+member,0==e.length?(f=null,f=null):(f=parseInt(e.first().attr("start_month")),g=parseInt(e.last().attr("start_month"))+1,f=10>f?"0"+f:f,g=10>g?"0"+g:g,f=currentYear+"-"+f,g=currentYear+"-"+g,j+="&start_month="+f+"&end_month="+g),common.gotoPage(j)})}function initPeriodArea(a,b){var d,e,f,g,h,c=$(".period-item");if(currentYear=(new Date).toStr("yyyy-MM").split("-")[0],a){for(d=a?a.split("-"):(new Date).toStr("yyyy-MM").split("-"),e=parseInt(d[0]),a=parseInt(d[1]),d=b.split("-"),f=parseInt(d[0]),b=parseInt(d[1]),g=0;g<c.length;g++)h=c.eq(g).attr("start_month"),h>=a&&b>=h&&c.eq(g).addClass("common-bg");b+=1,a=10>a?"0"+a:a,b=10>b?"0"+b:b}return[e+"-"+a+"-01",f+"-"+b+"-01"]}function loadData(){var a="/web/shanghui/queryFightingList.do";ajax.request({url:_base_url+a,need_progressbar:!1,params:{start_date:startDate,end_date:endDate,member:member},success:function(a,b){fightingList=b.fightingList,initStat(b.fightingList)}})}function initStat(a){var c,d,e,f,g,h,i,b=$(".stat-total-chart");if(b.width("100%"),b.height(20*a.length+50),c=[],d=[],a)for(e=0;e<a.length;e++)f=a[e],g=f.members,h=g?g[member]:0,c.push({y:h,color:0>h?"#FF0000":"#00FF00",fid:f.id}),d.push(f.date.toDate("-").toStr("MM/dd"));i=[{data:c,dataLabels:{enabled:!0}}],Highcharts.chart(b.get(0),{chart:{type:"bar"},title:{text:membernames[member].name+"实时战绩",style:{"font-size":"1rem"}},subtitle:{text:startDate+" ~ "+endDate},xAxis:[{categories:d,reversed:!0}],yAxis:{title:{text:"金额(元)"}},legend:{enabled:!1},plotOptions:{series:{stacking:"normal",pointWidth:13},bar:{cursor:"pointer",events:{click:function(a){var b=a.point;getMemberByName(b.category),common.gotoPage("score.html?sid="+b.options.fid)}}}},series:i})}var startDate,endDate,fightingList,huifei,shuil,member,currentYear;$(document).ready(function(){initPage()}),currentYear=null;